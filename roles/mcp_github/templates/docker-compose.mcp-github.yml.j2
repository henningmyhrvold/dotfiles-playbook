# docker-compose.mcp-github.yml.j2
# Managed by Ansible

services:
  {{ mcp_github_container_name }}:
    image: {{ mcp_github_image }}
    container_name: {{ mcp_github_container_name }}
    restart: unless-stopped
    working_dir: /app
    command: sh -c "npm install -g {{ mcp_github_npm_package }} && exec npx {{ mcp_github_npm_package }}"
    environment:
      - GITHUB_PERSONAL_ACCESS_TOKEN={{ github_token }}
    stdin_open: true
    tty: true
{% if mcp_network_mode == 'host' %}
    network_mode: host
{% else %}
    networks:
      - {{ mcp_docker_network }}
{% endif %}

{% if mcp_network_mode != 'host' %}
networks:
  {{ mcp_docker_network }}:
    external: true
{% endif %}
